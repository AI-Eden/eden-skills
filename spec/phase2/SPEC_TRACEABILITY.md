# SPEC_TRACEABILITY.md

Requirement-to-implementation mapping for Phase 2.
Use this file to recover accurate context after compression.
For remaining Builder-owned closeout audit work, see `spec/phase2/PHASE2_BUILDER_REMAINING.md`.

## 1. Architecture Requirements

| REQ_ID | Source | Requirement | Implementation | Tests | Status |
|---|---|---|---|---|---|
| ARC-001 | `SPEC_REACTOR.md` 4 | CLI MUST use `tokio` runtime for all network I/O | `crates/eden-skills-cli/src/main.rs` (`#[tokio::main]`), `crates/eden-skills-cli/src/lib.rs` (`run`/`run_with_args` async), `crates/eden-skills-cli/src/commands.rs` (`apply_async`/`repair_async`), `crates/eden-skills-core/src/source.rs` (`sync_sources_async`) | `crates/eden-skills-core/tests/source_sync_tests.rs`, `crates/eden-skills-core/tests/reactor_tests.rs` | implemented |
| ARC-002 | `SPEC_REACTOR.md` 4 | Skill downloads MUST be parallel with bounded concurrency (default: 10) | `crates/eden-skills-core/src/reactor.rs` (`SkillReactor`, `DEFAULT_CONCURRENCY_LIMIT`, `Semaphore` + `JoinSet`), `crates/eden-skills-core/src/source.rs` (source sync runs through `SkillReactor`) | `crates/eden-skills-core/tests/reactor_tests.rs` (`reactor_respects_bounded_concurrency_limit`) | implemented |
| ARC-003 | `SPEC_REACTOR.md` 4 | Disk I/O SHOULD be serialized per target path | `crates/eden-skills-cli/src/commands.rs` (`apply_async`/`repair_async` execute install mutations in deterministic sequential loop after Phase A barrier) | `crates/eden-skills-cli/tests/apply_repair.rs`, `crates/eden-skills-cli/tests/exit_code_matrix.rs` | implemented |
| ARC-004 | `SPEC_REACTOR.md` 4 | Concurrency limit SHOULD be configurable via config and CLI flag | `crates/eden-skills-core/src/config.rs` (`ReactorConfig` with `[reactor].concurrency` validation/default), `crates/eden-skills-cli/src/lib.rs` (global `--concurrency` for `apply`/`repair`/`update`), `crates/eden-skills-cli/src/commands.rs` (`resolve_effective_reactor_concurrency`) | `crates/eden-skills-core/tests/phase2_schema_tests.rs` (`reactor_concurrency_is_loaded_when_valid`, range validation), `crates/eden-skills-cli/tests/phase2_commands.rs` (`apply_and_repair_accept_concurrency_flag`, `apply_concurrency_flag_overrides_config_value_for_validation`) | implemented |
| ARC-005 | `SPEC_REACTOR.md` 4 | Reactor MUST implement two-phase execution (download then install) | `crates/eden-skills-core/src/reactor.rs` (`run_two_phase` barrier), `crates/eden-skills-cli/src/commands.rs` (`apply_async`/`repair_async`: source sync phase completes before mutation phase) | `crates/eden-skills-core/tests/reactor_tests.rs` (`reactor_enforces_two_phase_barrier`) | implemented |
| ARC-006 | `SPEC_REACTOR.md` 4 | Sync git ops MUST use `spawn_blocking` or async process to avoid blocking runtime | `crates/eden-skills-core/src/reactor.rs` (`run_blocking` uses `tokio::task::spawn_blocking`), `crates/eden-skills-core/src/source.rs` (clone/fetch/checkout wrapped in `run_blocking`) | `crates/eden-skills-core/tests/reactor_tests.rs` (`reactor_converts_spawn_blocking_panic_to_structured_error`), `crates/eden-skills-core/tests/source_sync_tests.rs` | implemented |
| ARC-007 | `SPEC_REACTOR.md` 4 | Reactor SHOULD support graceful cancellation via `CancellationToken` | `crates/eden-skills-core/src/reactor.rs` (`run_phase_a_with_cancellation`, cancellation-aware `JoinSet` abort/drain with partial outcome collection) | `crates/eden-skills-core/tests/reactor_tests.rs` (`reactor_supports_cancellation_with_partial_results`) | implemented |
| ARC-008 | `SPEC_REACTOR.md` 4 | Phase 2 domain errors MUST use `thiserror`; `anyhow` only at binary entry point | `crates/eden-skills-core/src/error.rs` (`ReactorError`, `AdapterError`, `RegistryError` via `thiserror` + conversion to `EdenError`) | `crates/eden-skills-core/tests/reactor_tests.rs`, workspace gate `cargo clippy --workspace -- -D warnings` | implemented |
| ARC-101 | `SPEC_ADAPTER.md` 4 | System MUST define `TargetAdapter` trait decoupling intent from syscalls | `crates/eden-skills-core/src/adapter.rs` (`TargetAdapter` async trait contract) | `crates/eden-skills-core/tests/adapter_tests.rs` (`target_adapter_trait_object_can_be_spawned_via_joinset`) | implemented |
| ARC-102 | `SPEC_ADAPTER.md` 4 | `LocalAdapter` MUST be provided for backward compatibility | `crates/eden-skills-core/src/adapter.rs` (`LocalAdapter` local health/path/install/exec implementations) | `crates/eden-skills-core/tests/adapter_tests.rs` (`local_adapter_install_copy_and_path_exists_work`, `local_adapter_symlink_supports_directory_and_file_sources`, `local_adapter_exec_runs_command`), Phase 1 regression gate (`cargo test --workspace`) | implemented |
| ARC-103 | `SPEC_ADAPTER.md` 4 | `DockerAdapter` MUST be provided using `docker` CLI | `crates/eden-skills-core/src/adapter.rs` (`DockerAdapter`, docker CLI wrapper via `tokio::process::Command`) | `crates/eden-skills-core/tests/adapter_tests.rs` (`docker_adapter_uses_docker_cli_for_health_install_and_exec`, `docker_adapter_health_check_fails_when_container_not_running`) | implemented |
| ARC-104 | `SPEC_ADAPTER.md` 4 | `DockerAdapter` MUST support `cp` injection strategy | `crates/eden-skills-core/src/adapter.rs` (`DockerAdapter::install` uses `docker cp` path injection regardless of host symlink semantics) | `crates/eden-skills-core/tests/adapter_tests.rs` (`docker_adapter_uses_docker_cli_for_health_install_and_exec`) | implemented |
| ARC-105 | `SPEC_ADAPTER.md` 4 | `DockerAdapter` MUST use `tokio::process::Command` for async interaction | `crates/eden-skills-core/src/adapter.rs` (`run_docker` + `DockerAdapter` operations based on `tokio::process::Command`) | `crates/eden-skills-core/tests/adapter_tests.rs` (`docker_adapter_uses_docker_cli_for_health_install_and_exec`) | implemented |
| ARC-106 | `SPEC_ADAPTER.md` 4 | Adapter selection MUST be deterministic from config `environment` field | `crates/eden-skills-core/src/adapter.rs` (`AdapterEnvironment`, `parse_environment`, `create_adapter`) | `crates/eden-skills-core/tests/adapter_tests.rs` (`parse_environment_is_deterministic`, `create_adapter_rejects_invalid_environment`) | implemented |
| ARC-107 | `SPEC_ADAPTER.md` 4 | `TargetAdapter` SHOULD include `uninstall` method | `crates/eden-skills-core/src/adapter.rs` (`TargetAdapter::uninstall`, `LocalAdapter::uninstall`, `DockerAdapter::uninstall`), `crates/eden-skills-cli/src/commands.rs` (`remove_async` + `uninstall_skill_targets` cleanup before config mutation) | `crates/eden-skills-core/tests/adapter_tests.rs` (`local_adapter_uninstall_removes_existing_target`, docker uninstall path), `crates/eden-skills-cli/tests/config_lifecycle.rs` (`remove_cleans_up_installed_local_target_path`) | implemented |
| ARC-108 | `SPEC_ADAPTER.md` 4 | `TargetAdapter` MUST require `Send + Sync` bounds (for `JoinSet::spawn`) | `crates/eden-skills-core/src/adapter.rs` (`pub trait TargetAdapter: Send + Sync`) | `crates/eden-skills-core/tests/adapter_tests.rs` (`target_adapter_trait_object_can_be_spawned_via_joinset`) | implemented |
| ARC-109 | `SPEC_ADAPTER.md` 4 | `LocalAdapter` MUST work on Linux, macOS, and Windows (platform APIs + tilde expansion) | `crates/eden-skills-core/src/adapter.rs` (`LocalAdapter::install` uses platform symlink APIs), `crates/eden-skills-core/src/paths.rs` (`HOME` -> `USERPROFILE` fallback) | `crates/eden-skills-core/tests/adapter_tests.rs` (`local_adapter_symlink_supports_directory_and_file_sources`), `crates/eden-skills-core/tests/paths_tests.rs` (`resolve_path_string_uses_userprofile_when_home_is_unset`, `resolve_path_string_prefers_home_when_home_and_userprofile_exist`) | implemented |
| ARC-110 | `SPEC_ADAPTER.md` 4 | Windows symlink privilege error SHOULD include actionable remediation hint | `crates/eden-skills-core/src/adapter.rs` (`map_windows_symlink_error` injects remediation hint), `crates/eden-skills-cli/src/commands.rs` (`map_windows_symlink_error` for direct apply symlink path) | `crates/eden-skills-core/tests/adapter_tests.rs` (`#[cfg(windows)] local_adapter_windows_symlink_permission_denied_includes_remediation_hint`), `crates/eden-skills-cli/tests/apply_repair.rs` (Windows path exercised in CI matrix) | implemented |
| ARC-201 | `SPEC_REGISTRY.md` 4 | Configuration MUST support multiple registries with priority weights | `crates/eden-skills-core/src/registry.rs` (`RegistrySpec`, `parse_registry_specs_from_toml`, `sort_registry_specs_by_priority`) | `crates/eden-skills-core/tests/registry_tests.rs` (`parse_registry_specs_supports_multiple_entries_with_priorities`) | implemented |
| ARC-202 | `SPEC_REGISTRY.md` 4 | Resolution MUST follow priority-based fallback order | `crates/eden-skills-core/src/registry.rs` (`RegistrySource`, `resolve_skill_from_registry_sources` sorted priority fallback) | `crates/eden-skills-core/tests/registry_tests.rs` (`resolve_skill_uses_priority_fallback_order`) | implemented |
| ARC-203 | `SPEC_REGISTRY.md` 4 | Registry indexes MUST be local Git repos synced via `eden update` | `crates/eden-skills-cli/src/commands.rs` (`update_async`, `sync_registry_task_blocking`, local `<storage.root>/registries/<name>` clone/fetch + `.eden-last-sync` marker) | `crates/eden-skills-cli/tests/phase2_commands.rs` (`update_clones_configured_registries`) | implemented |
| ARC-204 | `SPEC_REGISTRY.md` 4 | Registry index MUST contain `manifest.toml` with `format_version` | `crates/eden-skills-cli/src/commands.rs` (`validate_registry_manifest_for_resolution` enforces/validates manifest format and missing-manifest warning fallback) | `crates/eden-skills-cli/tests/phase2_commands.rs` (`install_resolves_skill_from_registry_and_persists_mode_b_entry`, `install_warns_when_registry_manifest_is_missing`) | implemented |
| ARC-205 | `SPEC_REGISTRY.md` 4 | Registry sync SHOULD use shallow clone (`--depth 1`) | `crates/eden-skills-cli/src/commands.rs` (`git clone --depth 1`, `git fetch --depth 1`) | `crates/eden-skills-cli/tests/phase2_commands.rs` (`update_clones_configured_registries` asserts `.git/shallow`) | implemented |
| ARC-206 | `SPEC_REGISTRY.md` 4 | Registry resolution MUST work offline from cached index | `crates/eden-skills-cli/src/commands.rs` (`resolve_registry_mode_skills_for_execution` resolves from local cache and emits actionable no-cache error) | `crates/eden-skills-cli/tests/phase2_commands.rs` (`install_resolves_skill_from_registry_and_persists_mode_b_entry`, `install_fails_with_update_hint_when_registry_cache_missing`) | implemented |
| ARC-207 | `SPEC_REGISTRY.md` 4 | Version constraint matching MUST use `semver` crate | `crates/eden-skills-core/src/registry.rs` (`select_version` with `semver::Version` + `semver::VersionReq`, exact pin handling) | `crates/eden-skills-core/tests/registry_tests.rs` (`resolve_skill_matches_semver_constraints`) | implemented |

## 2. Schema Extension Requirements

| REQ_ID | Source | Requirement | Implementation | Tests | Status |
|---|---|---|---|---|---|
| SCH-P2-001 | `SPEC_SCHEMA_EXT.md` 2 | `[registries]` section with `url`, `priority`, optional `auto_update` | `crates/eden-skills-core/src/config.rs` (`RawConfig::into_config` registry parsing and validation) | `crates/eden-skills-core/tests/phase2_schema_tests.rs` (`mode_b_skill_with_registries_is_accepted`) | implemented |
| SCH-P2-002 | `SPEC_SCHEMA_EXT.md` 3 | Mode B skill entries (`name` + `version` + optional `registry`) | `crates/eden-skills-core/src/config.rs` (`RawSkillConfig::into_skill`, Mode B mapping via `registry://` source encoding) | `crates/eden-skills-core/tests/phase2_schema_tests.rs` (`mode_b_skill_with_registries_is_accepted`, `mode_b_without_registries_returns_missing_registries_code`) | implemented |
| SCH-P2-003 | `SPEC_SCHEMA_EXT.md` 4 | `environment` field in targets (`local`, `docker:<name>`) | `crates/eden-skills-core/src/config.rs` (`RawTargetConfig::into_target_config`, `validate_environment`, default `local`) | `crates/eden-skills-core/tests/phase2_schema_tests.rs` (`invalid_target_environment_returns_invalid_environment_code`) | implemented |
| SCH-P2-004 | `SPEC_SCHEMA_EXT.md` 6 | Backward compatibility: Phase 1 configs remain valid without changes | `crates/eden-skills-core/src/config.rs` (Mode A path preserved; default behavior unchanged) | `crates/eden-skills-core/tests/config_tests.rs`, `crates/eden-skills-core/tests/phase2_schema_tests.rs` (`phase1_config_remains_valid_in_phase2_loader`) | implemented |
| SCH-P2-005 | `SPEC_SCHEMA_EXT.md` 5 | `[reactor]` section with `concurrency` field (optional, default 10) | `crates/eden-skills-core/src/config.rs` (`ReactorConfig`, `RawReactorConfig`, `INVALID_CONCURRENCY` validation, default 10) | `crates/eden-skills-core/tests/phase2_schema_tests.rs` (`reactor_concurrency_is_loaded_when_valid`, `reactor_concurrency_zero_returns_invalid_concurrency_code`, `reactor_concurrency_above_range_returns_invalid_concurrency_code`) | implemented |
| SCH-P2-006 | `SPEC_SCHEMA_EXT.md` 7 | Phase 2 validation errors MUST use stable error codes | `crates/eden-skills-core/src/config.rs` (`phase2_validation_error` for `INVALID_SKILL_MODE`, `MISSING_REGISTRIES`, `UNKNOWN_REGISTRY`, `INVALID_SEMVER`, `INVALID_ENVIRONMENT`, `DUPLICATE_SKILL_ID`) | `crates/eden-skills-core/tests/phase2_schema_tests.rs` | implemented |

## 3. Command Extension Requirements

| REQ_ID | Source | Requirement | Implementation | Tests | Status |
|---|---|---|---|---|---|
| CMD-P2-001 | `SPEC_COMMANDS_EXT.md` 2.1 | `update` command syncs registry indexes concurrently | `crates/eden-skills-cli/src/lib.rs` (`Commands::Update`), `crates/eden-skills-cli/src/commands.rs` (`update_async`, reactor-backed registry sync tasks) | `crates/eden-skills-cli/tests/phase2_commands.rs` (`update_clones_configured_registries`) | implemented |
| CMD-P2-002 | `SPEC_COMMANDS_EXT.md` 2.2 | `install` command resolves skills from registry by name | `crates/eden-skills-cli/src/lib.rs` (`Commands::Install`), `crates/eden-skills-cli/src/commands.rs` (`install_async`, `upsert_mode_b_skill`, registry resolution before sync) | `crates/eden-skills-cli/tests/phase2_commands.rs` (`install_resolves_skill_from_registry_and_persists_mode_b_entry`) | implemented |
| CMD-P2-003 | `SPEC_COMMANDS_EXT.md` 2.3 | `apply`/`repair` resolve Mode B skills through registry before source sync | `crates/eden-skills-cli/src/commands.rs` (`apply_async`/`repair_async` + `resolve_registry_mode_skills_for_execution`) | `crates/eden-skills-cli/tests/phase2_commands.rs` (`apply_and_repair_resolve_mode_b_skills_before_source_sync`) | implemented |
| CMD-P2-004 | `SPEC_COMMANDS_EXT.md` 2.3 | `doctor` emits Phase 2 finding codes (`REGISTRY_STALE`, `ADAPTER_HEALTH_FAIL`, `DOCKER_NOT_FOUND`) | `crates/eden-skills-cli/src/commands.rs` (`collect_phase2_doctor_findings`, registry staleness + docker availability/health checks) | `crates/eden-skills-cli/tests/phase2_doctor.rs` | implemented |
| CMD-P2-005 | `SPEC_COMMANDS_EXT.md` 4 | `--concurrency` global flag overrides reactor concurrency | `crates/eden-skills-cli/src/lib.rs` (flag wiring for `apply`/`repair`/`update`), `crates/eden-skills-cli/src/commands.rs` (`resolve_effective_reactor_concurrency`, `apply_async`/`repair_async`/`update_async` override precedence) | `crates/eden-skills-cli/tests/phase2_commands.rs` (`apply_and_repair_accept_concurrency_flag`, `apply_concurrency_flag_overrides_config_value_for_validation`) | implemented |
| CMD-P2-006 | `SPEC_COMMANDS_EXT.md` 2.2 | `install --dry-run` displays resolution without side effects | `crates/eden-skills-cli/src/lib.rs` (`InstallArgs::dry_run`), `crates/eden-skills-cli/src/commands.rs` (`install_async` dry-run branch with resolved source/target output and no mutation path) | `crates/eden-skills-cli/tests/phase2_commands.rs` (`install_dry_run_displays_resolution_without_side_effects`) | implemented |

## 4. Test Matrix Coverage

| SCENARIO_ID | Source | Scenario | Automated Test | Status |
|---|---|---|---|---|
| TM-P2-001 | `SPEC_TEST_MATRIX.md` 2.1 | Concurrent download | `crates/eden-skills-core/tests/reactor_tests.rs` (`reactor_respects_bounded_concurrency_limit`) | implemented (reactor-level) |
| TM-P2-002 | `SPEC_TEST_MATRIX.md` 2.2 | Bounded concurrency | `crates/eden-skills-core/tests/reactor_tests.rs` (`reactor_respects_bounded_concurrency_limit`) | implemented |
| TM-P2-003 | `SPEC_TEST_MATRIX.md` 2.3 | Partial download failure | `crates/eden-skills-core/tests/source_sync_tests.rs` (`sync_sources_continues_after_failure_and_aggregates_results`), `crates/eden-skills-cli/tests/exit_code_matrix.rs` (`apply_aggregates_multiskill_source_failures_in_config_order`) | implemented |
| TM-P2-004 | `SPEC_TEST_MATRIX.md` 2.4 | Phase 1 backward compatibility | Phase 1 integration regression suites in `crates/eden-skills-cli/tests/` (`apply_repair.rs`, `exit_code_matrix.rs`, `doctor_*`, `config_lifecycle.rs`) plus workspace quality gate `cargo test --workspace` | implemented (regression-gate) |
| TM-P2-005 | `SPEC_TEST_MATRIX.md` 3.1 | LocalAdapter parity | `crates/eden-skills-core/tests/adapter_tests.rs` (`local_adapter_install_copy_and_path_exists_work`, `local_adapter_symlink_supports_directory_and_file_sources`, `local_adapter_exec_runs_command`) | implemented (adapter core contract level) |
| TM-P2-006 | `SPEC_TEST_MATRIX.md` 3.2 | DockerAdapter install | `crates/eden-skills-core/tests/adapter_tests.rs` (`docker_adapter_uses_docker_cli_for_health_install_and_exec`) | implemented (docker CLI stubbed integration) |
| TM-P2-007 | `SPEC_TEST_MATRIX.md` 3.3 | DockerAdapter health check | `crates/eden-skills-core/tests/adapter_tests.rs` (`docker_adapter_health_check_fails_when_container_not_running`) | implemented |
| TM-P2-008 | `SPEC_TEST_MATRIX.md` 4.1 | Registry update | `crates/eden-skills-cli/tests/phase2_commands.rs` (`update_clones_configured_registries`) | implemented (clone path) |
| TM-P2-009 | `SPEC_TEST_MATRIX.md` 4.2 | Registry resolution | `crates/eden-skills-core/tests/registry_tests.rs` (`resolve_skill_uses_priority_fallback_order`) | implemented (core resolver contract level) |
| TM-P2-010 | `SPEC_TEST_MATRIX.md` 4.3 | Version constraint matching | `crates/eden-skills-core/tests/registry_tests.rs` (`resolve_skill_matches_semver_constraints`) | implemented |
| TM-P2-011 | `SPEC_TEST_MATRIX.md` 4.4 | Schema extension validation | `crates/eden-skills-core/tests/phase2_schema_tests.rs` | implemented |
| TM-P2-012 | `SPEC_TEST_MATRIX.md` 2.5 | Two-phase execution | `crates/eden-skills-core/tests/reactor_tests.rs` (`reactor_enforces_two_phase_barrier`) | implemented |
| TM-P2-013 | `SPEC_TEST_MATRIX.md` 2.6 | Concurrency configuration | `crates/eden-skills-cli/tests/phase2_commands.rs` (`apply_and_repair_accept_concurrency_flag`, `apply_concurrency_flag_overrides_config_value_for_validation`), `crates/eden-skills-core/tests/phase2_schema_tests.rs` (reactor config range/default parsing) | implemented |
| TM-P2-014 | `SPEC_TEST_MATRIX.md` 2.7 | Spawn blocking safety | `crates/eden-skills-core/tests/reactor_tests.rs` (`reactor_converts_spawn_blocking_panic_to_structured_error`), `crates/eden-skills-core/src/source.rs` (`run_blocking` integration) | implemented |
| TM-P2-015 | `SPEC_TEST_MATRIX.md` 3.5 | DockerAdapter symlink fallback | `crates/eden-skills-core/src/adapter.rs` (`DockerAdapter::resolve_install_mode`, `DockerAdapter::install` warning + copy fallback), `crates/eden-skills-core/tests/adapter_tests.rs` (`docker_adapter_symlink_mode_emits_warning_and_falls_back_to_copy`) | implemented |
| TM-P2-016 | `SPEC_TEST_MATRIX.md` 3.6 | Adapter selection determinism | `crates/eden-skills-core/tests/adapter_tests.rs` (`parse_environment_is_deterministic`, `create_adapter_rejects_invalid_environment`) | implemented |
| TM-P2-017 | `SPEC_TEST_MATRIX.md` 3.7 | Docker binary missing | `crates/eden-skills-core/tests/adapter_tests.rs` (`docker_adapter_reports_missing_binary_at_construction`) | implemented |
| TM-P2-018 | `SPEC_TEST_MATRIX.md` 4.5 | Offline resolution | `crates/eden-skills-cli/tests/phase2_commands.rs` (`install_resolves_skill_from_registry_and_persists_mode_b_entry`, `install_fails_with_update_hint_when_registry_cache_missing`) | implemented |
| TM-P2-019 | `SPEC_TEST_MATRIX.md` 4.6 | Shallow clone efficiency | `crates/eden-skills-cli/tests/phase2_commands.rs` (`update_clones_configured_registries` asserts `.git/shallow`) | implemented |
| TM-P2-020 | `SPEC_TEST_MATRIX.md` 4.7 | Yanked version handling | `crates/eden-skills-core/tests/registry_tests.rs` (`resolve_skill_excludes_yanked_versions_and_reports_available_non_yanked_versions`) | implemented |
| TM-P2-021 | `SPEC_TEST_MATRIX.md` 4.8 | Registry manifest validation | `crates/eden-skills-cli/tests/phase2_commands.rs` (`install_resolves_skill_from_registry_and_persists_mode_b_entry`, `install_warns_when_registry_manifest_is_missing`) | implemented |
| TM-P2-022 | `SPEC_TEST_MATRIX.md` 4.9 | Reactor config validation | `crates/eden-skills-core/tests/phase2_schema_tests.rs` (`reactor_concurrency_is_loaded_when_valid`, `reactor_concurrency_zero_returns_invalid_concurrency_code`, `reactor_concurrency_above_range_returns_invalid_concurrency_code`) | implemented |
| TM-P2-023 | `SPEC_TEST_MATRIX.md` 4.10 | Install dry run | `crates/eden-skills-cli/tests/phase2_commands.rs` (`install_dry_run_displays_resolution_without_side_effects`) | implemented |
| TM-P2-024 | `SPEC_TEST_MATRIX.md` 3.4 | DockerAdapter permission handling | `crates/eden-skills-core/tests/adapter_tests.rs` (`docker_adapter_install_permission_failure_includes_container_and_target_path`) | implemented |
| TM-P2-025 | `SPEC_TEST_MATRIX.md` 5.1 | Tilde expansion portability (HOME/USERPROFILE) | `crates/eden-skills-core/tests/paths_tests.rs` (`resolve_path_string_uses_userprofile_when_home_is_unset`, `resolve_path_string_prefers_home_when_home_and_userprofile_exist`) | implemented (linux/macos/windows hosted CI verified, run `22139248260`) |
| TM-P2-026 | `SPEC_TEST_MATRIX.md` 5.2 | Cross-platform symlink creation | `crates/eden-skills-core/tests/symlink_canonical_tests.rs` (`#[cfg(unix)]` + `#[cfg(windows)]` parity modules), `crates/eden-skills-cli/tests/exit_code_matrix.rs` (`apply_strict_returns_exit_code_3_on_target_conflict` unix/windows variants) | implemented (linux/macos/windows hosted CI verified, run `22139248260`) |
| TM-P2-027 | `SPEC_TEST_MATRIX.md` 5.3 | Windows symlink privilege error | `crates/eden-skills-core/tests/adapter_tests.rs` (`#[cfg(windows)] local_adapter_windows_symlink_permission_denied_includes_remediation_hint`) | implemented (Windows-only deterministic ACL harness) |
| TM-P2-028 | `SPEC_TEST_MATRIX.md` 5.4 | Cross-platform path normalization | `crates/eden-skills-core/tests/paths_tests.rs` (`normalize_lexical_collapses_dot_and_dotdot`) with Unix and Windows path-shape assertions | implemented |
| TM-P2-029 | `SPEC_TEST_MATRIX.md` 5.5 | Windows safety detection graceful degradation | `crates/eden-skills-core/src/safety.rs` (`detect_file_risk` keeps execute-bit probing under `#[cfg(unix)]`), `crates/eden-skills-core/tests/safety_tests.rs` (`#[cfg(windows)] windows_safety_detection_skips_unix_exec_bit_and_keeps_other_risk_labels`) | implemented |
| TM-P2-030 | `SPEC_TEST_MATRIX.md` 4.11 | Pre-release version resolution | `crates/eden-skills-core/tests/registry_tests.rs` (`resolve_skill_handles_prerelease_matching_and_default_selection`) | implemented |
| TM-P2-031 | `SPEC_TEST_MATRIX.md` 4.12 | Registry staleness detection (doctor) | `crates/eden-skills-cli/tests/phase2_doctor.rs` (`doctor_emits_registry_stale_when_last_sync_is_older_than_7_days`) | implemented |
| TM-P2-032 | `SPEC_TEST_MATRIX.md` 4.13 | Mode A/B identifier collision validation | `crates/eden-skills-core/tests/phase2_schema_tests.rs` (`mode_a_mode_b_identifier_collision_returns_duplicate_skill_id_code`) | implemented |
| TM-P2-033 | `SPEC_TEST_MATRIX.md` 4.14 | Install config persistence | `crates/eden-skills-cli/tests/phase2_commands.rs` (`install_resolves_skill_from_registry_and_persists_mode_b_entry`) | implemented (add/persist path) |

## 5. Phase 1 Windows Prerequisite Tasks

These tasks fix Phase 1 implementation for Windows compatibility. They have
**no dependency on Phase 2 architecture** and SHOULD start immediately
(before or in parallel with Phase 2 implementation). They are tracked here
because the Phase 2 CI Gate (Section 7) requires Phase 1 tests to pass on
Windows. Phase 1 specs remain frozen; these are code-only changes.

**Cross-track dependency:** ARC-109 (LocalAdapter cross-platform) depends
on WIN-001 (USERPROFILE fallback) being completed first.

| TASK_ID | Source | Task | Implementation | Status |
|---|---|---|---|---|
| WIN-001 | `SPEC_TEST_MATRIX.md` 6.1 | `user_home_dir()` USERPROFILE fallback | `crates/eden-skills-core/src/paths.rs`; tests in `crates/eden-skills-core/tests/paths_tests.rs` | implemented |
| WIN-002 | `SPEC_TEST_MATRIX.md` 6.2 | Fix hardcoded `/tmp` paths in tests (Category A: filesystem access) | `crates/eden-skills-cli/tests/apply_repair.rs` (broken symlink temp path), `crates/eden-skills-core/tests/paths_tests.rs` (platform-conditional normalization assertion) | implemented |
| WIN-003 | `SPEC_TEST_MATRIX.md` 6.2 | Verify `/tmp` string placeholders pass on Windows (Category B) | Verified placeholder-only usages remain string/config literals in existing tests (no filesystem access) | verified (no code change required) |
| WIN-004 | `SPEC_TEST_MATRIX.md` 6.3 | Add `#[cfg(windows)]` test equivalents for Unix-only tests | `crates/eden-skills-core/tests/symlink_canonical_tests.rs`, `crates/eden-skills-core/tests/plan_copy_edge_tests.rs`, `crates/eden-skills-cli/tests/apply_repair.rs`, `crates/eden-skills-cli/tests/exit_code_matrix.rs`, `crates/eden-skills-cli/tests/common/mod.rs` (Windows ACL helpers) | implemented (hosted Windows CI verified, run `22139248260`) |
| WIN-005 | `SPEC_TEST_MATRIX.md` 6.4 | Enable `windows-latest` in CI workflow | `.github/workflows/ci.yml` (matrix `os` includes `windows-latest`) | implemented (hosted Windows CI verified, run `22139248260`) |
